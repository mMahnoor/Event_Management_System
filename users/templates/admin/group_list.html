{% extends "base.html" %}
{% block title %}Groups{% endblock title %}
{% load static %}
{% block content %}
    <div class="pt-48 bg-[#523824] pb-20 px-4 flex flex-col md:flex-row justify-center gap-16">
        <img src="{% static "Images/m_custom_garland.svg" %}" alt="" class="absolute top-[80px] w-[600px] left-0 sm:left-16 opacity-10">
        <div  class="w-full md:w-1/3 flex flex-col gap-2 justify-start items-center">
            <h2 class="relative text-3xl font-bold mb-4 text-yellow-600 text-center">
                Groups and Permissions
                <img src="{% static "Images/m_custom_garland.svg" %}" alt="" class="absolute top-12 left-12 sm:top-0 sm:left-0 w-[200px] sm:w-[800px] -hue-rotate-30 opacity-80">
            </h2>
            <img src="{% static "Images/groups_work.svg" %}" alt="" class="w-80 p-6">
            <button class="bg-yellow-800 hover:bg-yellow-400 text-sm text-white font-bold capitalize px-4 py-2 rounded shadow-md hover:-translate-y-1 hover:duration-300" onclick="document.getElementById('formDialog').showModal()">âœš Create group</button>
            {% comment %} Form modal {% endcomment %}
            {% url 'create-group' as action_url %}
            {% include "Widgets/formModal.html" with form_dialog_id="formDialog" action_url=action_url button_text="Create" form_title="Create Group" %}
        </div>
        <div>
            <div class="mb-2 a">
                {% if messages %}
                    {% include "Widget/Alerts.html" with messages=messages %}
                {% endif %}
            </div>
            <div class="overflow-x-auto rounded-md">
                <table class="table-auto w-full border-collapse border border-yellow-300 rounded-md text-yellow-800">
                    <thead>
                        <tr class="bg-yellow-100">
                            <th class="border border-yellow-300 px-4 py-2">Group Name</th>
                            <th class="border border-yellow-300 px-4 py-2">Permissions</th>
                            <th class="border border-yellow-300 px-4 py-2">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for group in groups %}
                            <tr class="odd:bg-yellow-50 even:bg-yellow-100">
                            <td class="border border-yellow-300 px-4 py-2 font-medium">
                                {{group.name}}
                            </td>
                            <td class="border border-yellow-300 px-4 py-2">
                                <ul class="list-disc list-inside">
                                    {% for permission in group.permissions.all %}
                                        <li>{{permission.name}}|{{permission.codename}}</li>
                                    {% empty %}
                                        <span class="text-gray-500 italic">No permissions assigned</span>
                                    {% endfor %}
                                </ul>
                            </td>
                            <td class="border border-yellow-300 px-4 py-2 font-medium">
                                <a href="{% url "delete-group" group.id %}"><button class="px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-md">Delete</button></a>
                            </td>
                            </tr>
                        {% endfor %}
                        
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock content %}